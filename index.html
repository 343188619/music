<!DOCTYPE html>
<html lang="zh-CN">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>高级音乐播放器</title>
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
	<style>
		:root {
			--primary-color: rgba(0, 122, 255, 0.95);
			--secondary-color: rgba(88, 86, 214, 0.95);
			--accent-color: #ff5e7d;
			--text-color: #333;
			--bg-color: rgba(255, 255, 255, 0.95);
			--glass-border: rgba(255, 255, 255, 0.2);
			--glass-shadow: 0 8px 32px rgba(31, 38, 135, 0.15);
			--glass-backdrop: blur(16px) saturate(180%);
			--card-bg: rgba(255, 255, 255, 0.85);
			--transition: all 0.5s cubic-bezier(0.25, 0.8, 0.25, 1);
			--highlight-color: rgba(0, 122, 255, 0.1);
			--bg-gradient-1: #f5f7fa;
			--bg-gradient-2: #e4e8f0;
			--bg-gradient-3: #d8e1e8;
			--bg-gradient-4: #c9d6df;
		}

		.dark-mode {
			--primary-color: rgba(10, 132, 255, 0.95);
			--secondary-color: rgba(94, 92, 230, 0.95);
			--accent-color: #ff5e7d;
			--text-color: #f5f5f7;
			--bg-color: rgba(28, 28, 30, 0.95);
			--glass-border: rgba(0, 0, 0, 0.2);
			--glass-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
			--card-bg: rgba(44, 44, 46, 0.85);
			--highlight-color: rgba(0, 122, 255, 0.2);
			--bg-gradient-1: #1a1a2e;
			--bg-gradient-2: #16213e;
			--bg-gradient-3: #0f3460;
			--bg-gradient-4: #533d7d;
		}

		* {
			margin: 0;
			padding: 0;
			box-sizing: border-box;
			font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
		}

		body {
			background: linear-gradient(-45deg, var(--bg-gradient-1), var(--bg-gradient-2), var(--bg-gradient-3), var(--bg-gradient-4));
			background-size: 400% 400%;
			animation: gradientBG 15s ease infinite;
			color: var(--text-color);
			min-height: 100vh;
			display: flex;
			flex-direction: column;
			align-items: center;
			padding: 20px;
			overflow-x: hidden;
			transition: var(--transition);
		}

		@keyframes gradientBG {
			0% { background-position: 0% 50%; }
			50% { background-position: 100% 50%; }
			100% { background-position: 0% 50%; }
		}

		.container {
			width: 100%;
			max-width: 900px;
			margin: 0 auto;
			opacity: 0;
			transform: translateY(20px);
			animation: fadeInUp 0.8s cubic-bezier(0.39, 0.575, 0.565, 1) forwards;
			animation-delay: 0.3s;
		}

		@keyframes fadeInUp {
			to { opacity: 1; transform: translateY(0); }
		}

		.glass-panel {
			background: var(--bg-color);
			border-radius: 25px;
			border: 1px solid var(--glass-border);
			backdrop-filter: var(--glass-backdrop);
			-webkit-backdrop-filter: var(--glass-backdrop);
			box-shadow: var(--glass-shadow);
			padding: 35px;
			margin-bottom: 25px;
			transition: var(--transition);
			position: relative;
			overflow: hidden;
			opacity: 0;
			transform: translateY(20px);
			animation: fadeInUp 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
			animation-delay: 0.5s;
		}

		.glass-panel::before {
			content: '';
			position: absolute;
			top: -50%;
			left: -50%;
			width: 200%;
			height: 200%;
			background: radial-gradient(circle at center, 
									  rgba(255, 255, 255, 0.1) 0%, 
									  transparent 70%);
			animation: rotateGradient 20s linear infinite;
			z-index: -1;
		}

		@keyframes rotateGradient {
			from { transform: rotate(0deg); }
			to { transform: rotate(360deg); }
		}

		h1 {
			font-size: 3rem;
			font-weight: 700;
			margin-bottom: 30px;
			text-align: center;
			background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
			-webkit-background-clip: text;
			background-clip: text;
			color: transparent;
			animation: textShine 3s ease-in-out infinite alternate;
			text-shadow: 0 2px 10px rgba(0, 122, 255, 0.3);
			opacity: 0;
			transform: translateY(20px);
			animation: fadeInUp 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards, textShine 3s ease-in-out infinite alternate;
			animation-delay: 0.7s;
		}

		@keyframes textShine {
			0% { background-position: 0% 50%; }
			100% { background-position: 100% 50%; }
		}

		.search-container {
			display: flex;
			gap: 15px;
			margin-bottom: 30px;
			opacity: 0;
			transform: translateY(20px);
			animation: fadeInUp 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
			animation-delay: 0.9s;
		}

		input[type="text"] {
			flex: 1;
			padding: 18px 25px;
			border: none;
			border-radius: 15px;
			background: var(--card-bg);
			color: var(--text-color);
			font-size: 1.1rem;
			outline: none;
			transition: var(--transition);
			box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1),
						inset 0 1px 2px rgba(255, 255, 255, 0.1);
			border: 1px solid rgba(255, 255, 255, 0.05);
			opacity: 0;
			transform: translateY(20px);
			animation: fadeInUp 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
			animation-delay: 1s;
		}

		input[type="text"]:focus {
			box-shadow: 0 5px 20px rgba(0, 122, 255, 0.3),
						inset 0 1px 2px rgba(255, 255, 255, 0.1);
			border-color: rgba(0, 122, 255, 0.3);
		}

		button {
			padding: 18px 30px;
			border: none;
			border-radius: 15px;
			background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
			color: white;
			font-size: 1.1rem;
			font-weight: 500;
			cursor: pointer;
			transition: var(--transition);
			box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2),
						inset 0 1px 2px rgba(255, 255, 255, 0.1);
			position: relative;
			overflow: hidden;
			opacity: 0;
			transform: translateY(20px);
			animation: fadeInUp 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
			animation-delay: 1.1s;
		}

		button::after {
			content: '';
			position: absolute;
			top: -100%;
			left: -100%;
			width: 300%;
			height: 300%;
			background: linear-gradient(
				to bottom right,
				rgba(255, 255, 255, 0.3) 0%,
				rgba(255, 255, 255, 0) 60%
			);
			transform: rotate(30deg);
			transition: all 0.5s ease;
		}

		button:hover {
			transform: translateY(-3px);
			box-shadow: 0 8px 20px rgba(0, 122, 255, 0.4);
		}

		button:hover::after {
			top: -50%;
			left: -50%;
		}

		button:active {
			transform: translateY(0);
			box-shadow: 0 5px 10px rgba(0, 122, 255, 0.3);
		}

		.quality-selector {
			display: flex;
			flex-wrap: wrap;
			gap: 12px;
			margin-bottom: 30px;
			justify-content: center;
			opacity: 0;
			transform: translateY(20px);
			animation: fadeInUp 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
			animation-delay: 1.2s;
		}

		.quality-btn {
			padding: 12px 20px;
			border-radius: 12px;
			background: var(--card-bg);
			color: var(--text-color);
			font-size: 0.9rem;
			cursor: pointer;
			transition: var(--transition);
			box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1),
						inset 0 1px 2px rgba(255, 255, 255, 0.1);
			border: 1px solid rgba(255, 255, 255, 0.05);
			opacity: 0;
			transform: translateY(20px);
			animation: fadeInUp 0.5s ease-out forwards;
		}

		.quality-btn:nth-child(1) { animation-delay: 1.3s; }
		.quality-btn:nth-child(2) { animation-delay: 1.4s; }
		.quality-btn:nth-child(3) { animation-delay: 1.5s; }
		.quality-btn:nth-child(4) { animation-delay: 1.6s; }
		.quality-btn:nth-child(5) { animation-delay: 1.7s; }

		.quality-btn.active {
			background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
			color: white;
			box-shadow: 0 4px 15px rgba(0, 122, 255, 0.3);
			border-color: transparent;
		}

		.quality-btn:hover {
			transform: translateY(-2px);
			box-shadow: 0 6px 15px rgba(0, 0, 0, 0.2);
		}

		.loading {
			display: none;
			text-align: center;
			margin: 40px 0;
			opacity: 0;
			transform: scale(0.9);
			animation: fadeInScale 0.5s ease-out forwards;
		}

		@keyframes fadeInScale {
			to { opacity: 1; transform: scale(1); }
		}

		.loading-spinner {
			width: 60px;
			height: 60px;
			border: 5px solid rgba(0, 122, 255, 0.2);
			border-radius: 50%;
			border-top-color: var(--primary-color);
			animation: spin 1.5s linear infinite;
			margin: 0 auto 15px;
			box-shadow: 0 0 20px rgba(0, 122, 255, 0.3);
		}

		@keyframes spin {
			to { transform: rotate(360deg); }
		}

		.error-message {
			color: var(--accent-color);
			text-align: center;
			margin: 30px 0;
			display: none;
			font-size: 1.1rem;
			font-weight: 500;
			animation: shake 0.5s ease;
			opacity: 0;
			transform: translateY(20px);
			animation: fadeInUp 0.5s ease-out forwards, shake 0.5s ease;
		}

		@keyframes shake {
			0%, 100% { transform: translateX(0); }
			20%, 60% { transform: translateX(-5px); }
			40%, 80% { transform: translateX(5px); }
		}

		.search-results {
			max-height: 400px;
			overflow-y: auto;
			margin-bottom: 30px;
			display: none;
			opacity: 0;
			transform: translateY(20px);
			animation: fadeInUp 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
		}

		.search-result-item {
			padding: 18px;
			border-radius: 15px;
			background: var(--card-bg);
			margin-bottom: 12px;
			cursor: pointer;
			transition: var(--transition);
			display: flex;
			align-items: center;
			gap: 18px;
			box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
			border: 1px solid rgba(255, 255, 255, 0.05);
			opacity: 0;
			transform: translateY(10px);
			animation: fadeInUpItem 0.5s ease-out forwards;
		}

		@keyframes fadeInUpItem {
			to { opacity: 1; transform: translateY(0); }
		}

		.search-result-item:hover {
			transform: translateY(-3px);
			box-shadow: 0 8px 20px rgba(0, 122, 255, 0.2);
			background: var(--highlight-color);
		}

		.search-result-cover {
			width: 60px;
			height: 60px;
			border-radius: 10px;
			object-fit: cover;
			box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
		}

		.search-result-info {
			flex: 1;
		}

		.search-result-title {
			font-weight: 500;
			margin-bottom: 5px;
			white-space: nowrap;
			overflow: hidden;
			text-overflow: ellipsis;
			font-size: 1.1rem;
		}

		.search-result-artist {
			font-size: 0.9rem;
			opacity: 0.7;
			white-space: nowrap;
			overflow: hidden;
			text-overflow: ellipsis;
		}

		.player-container {
			display: none;
			flex-direction: column;
			align-items: center;
			margin: 40px 0;
			width: 100%;
			opacity: 0;
			transform: translateY(20px);
			animation: fadeInUp 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
		}

		.song-info {
			text-align: center;
			margin-bottom: 35px;
			width: 100%;
		}

		.song-title {
			font-size: 2rem;
			font-weight: 600;
			margin-bottom: 10px;
			white-space: nowrap;
			overflow: hidden;
			text-overflow: ellipsis;
			max-width: 100%;
			text-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
			opacity: 0;
			transform: translateY(20px);
			animation: fadeInUp 0.5s ease-out forwards;
			animation-delay: 0.2s;
		}

		.song-artist {
			font-size: 1.4rem;
			color: var(--text-color);
			opacity: 0.8;
			margin-bottom: 15px;
			opacity: 0;
			transform: translateY(20px);
			animation: fadeInUp 0.5s ease-out forwards;
			animation-delay: 0.3s;
		}

		.song-album {
			font-size: 1.1rem;
			color: var(--text-color);
			opacity: 0.6;
			margin-bottom: 25px;
			opacity: 0;
			transform: translateY(20px);
			animation: fadeInUp 0.5s ease-out forwards;
			animation-delay: 0.4s;
		}

		.album-cover {
			width: 280px;
			height: 280px;
			border-radius: 20px;
			object-fit: cover;
			box-shadow: 0 15px 30px rgba(0, 0, 0, 0.3);
			margin-bottom: 35px;
			transition: var(--transition);
			animation: float 6s ease-in-out infinite;
			border: 2px solid rgba(255, 255, 255, 0.1);
			opacity: 0;
			transform: translateY(20px) scale(0.9);
			animation: fadeInUpScale 0.8s cubic-bezier(0.23, 1, 0.32, 1) forwards, float 6s ease-in-out infinite;
			animation-delay: 0.5s;
		}

		@keyframes fadeInUpScale {
			to { opacity: 1; transform: translateY(0) scale(1); }
		}

		@keyframes float {
			0%, 100% { transform: translateY(0) rotate(0deg); }
			50% { transform: translateY(-20px) rotate(2deg); }
		}

		.progress-container {
			width: 100%;
			height: 8px;
			background: rgba(0, 0, 0, 0.1);
			border-radius: 4px;
			margin: 30px 0;
			cursor: pointer;
			overflow: hidden;
			position: relative;
			box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.2);
			opacity: 0;
			transform: translateY(20px);
			animation: fadeInUp 0.5s ease-out forwards;
			animation-delay: 0.6s;
		}

		.progress-container::before {
			content: '';
			position: absolute;
			top: 0;
			left: 0;
			right: 0;
			bottom: 0;
			background: linear-gradient(
				to right,
				transparent,
				rgba(255, 255, 255, 0.1),
				transparent
			);
			animation: progressShine 3s linear infinite;
			opacity: 0.5;
		}

		@keyframes progressShine {
			0% { transform: translateX(-100%); }
			100% { transform: translateX(100%); }
		}

		.progress-bar {
			height: 100%;
			background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
			border-radius: 4px;
			width: 0%;
			transition: width 0.1s linear;
			position: relative;
			overflow: hidden;
		}

		.progress-bar::after {
			content: '';
			position: absolute;
			top: 0;
			left: 0;
			right: 0;
			bottom: 0;
			background: linear-gradient(
				to right,
				rgba(255, 255, 255, 0.3),
				rgba(255, 255, 255, 0)
			);
			animation: progressShine 2s linear infinite;
		}

		.time-info {
			display: flex;
			justify-content: space-between;
			width: 100%;
			font-size: 0.9rem;
			color: var(--text-color);
			opacity: 0.7;
			margin-bottom: 30px;
			opacity: 0;
			transform: translateY(20px);
			animation: fadeInUp 0.5s ease-out forwards;
			animation-delay: 0.7s;
		}

		.controls {
			display: flex;
			align-items: center;
			gap: 30px;
			margin-bottom: 40px;
			opacity: 0;
			transform: translateY(20px);
			animation: fadeInUp 0.5s ease-out forwards;
			animation-delay: 0.8s;
		}

		.control-btn {
			width: 70px;
			height: 70px;
			border-radius: 50%;
			display: flex;
			align-items: center;
			justify-content: center;
			background: var(--card-bg);
			color: var(--text-color);
			cursor: pointer;
			transition: var(--transition);
			box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2),
						inset 0 1px 2px rgba(255, 255, 255, 0.1);
			border: 1px solid rgba(255, 255, 255, 0.05);
			position: relative;
			overflow: hidden;
		}

		.control-btn:nth-child(1) { animation-delay: 0.8s; }
		.control-btn:nth-child(2) { animation-delay: 0.9s; }
		.control-btn:nth-child(3) { animation-delay: 1.0s; }

		.control-btn::before {
			content: '';
			position: absolute;
			top: 0;
			left: 0;
			width: 100%;
			height: 100%;
			background: radial-gradient(
				circle at center,
				rgba(255, 255, 255, 0.1) 0%,
				transparent 70%
			);
			opacity: 0;
			transition: opacity 0.3s ease;
		}

		.control-btn:hover {
			transform: translateY(-5px) scale(1.05);
			box-shadow: 0 12px 25px rgba(0, 122, 255, 0.3);
		}

		.control-btn:hover::before {
			opacity: 1;
		}

		.control-btn:active {
			transform: translateY(0) scale(0.98);
			box-shadow: 0 5px 15px rgba(0, 122, 255, 0.2);
		}

		.control-btn.play-pause {
			width: 90px;
			height: 90px;
			background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
			color: white;
			box-shadow: 0 10px 25px rgba(0, 122, 255, 0.4);
		}

		.control-btn i {
			font-size: 1.6rem;
			position: relative;
			z-index: 1;
		}

		.play-pause i {
			font-size: 2.2rem;
		}

		.song-quality {
			font-size: 0.9rem;
			color: var(--text-color);
			opacity: 0.7;
			margin-bottom: 5px;
			opacity: 0;
			transform: translateY(20px);
			animation: fadeInUp 0.5s ease-out forwards;
			animation-delay: 0.9s;
		}

		.song-size {
			font-size: 0.9rem;
			color: var(--text-color);
			opacity: 0.7;
			margin-bottom: 25px;
			opacity: 0;
			transform: translateY(20px);
			animation: fadeInUp 0.5s ease-out forwards;
			animation-delay: 1.0s;
		}

		.song-url-container {
			width: 100%;
			margin: 30px 0;
			opacity: 0;
			transform: translateY(20px);
			animation: fadeInUp 0.5s ease-out forwards;
			animation-delay: 1.1s;
		}

		.song-url-label {
			font-size: 0.9rem;
			color: var(--text-color);
			opacity: 0.7;
			margin-bottom: 15px;
			display: block;
			text-align: center;
		}

		.song-url-input {
			width: 100%;
			padding: 18px 25px;
			border-radius: 15px;
			background: var(--card-bg);
			border: none;
			color: var(--text-color);
			font-size: 0.9rem;
			outline: none;
			transition: var(--transition);
			box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1),
						inset 0 1px 2px rgba(255, 255, 255, 0.1);
			border: 1px solid rgba(255, 255, 255, 0.05);
			margin-bottom: 15px;
		}

		.song-url-input:focus {
			box-shadow: 0 5px 20px rgba(0, 122, 255, 0.3);
			border-color: rgba(0, 122, 255, 0.3);
		}

		.copy-url-btn {
			width: 100%;
			padding: 18px;
			border-radius: 15px;
			background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
			color: white;
			font-size: 1.1rem;
			font-weight: 500;
			cursor: pointer;
			transition: var(--transition);
			box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
			border: none;
			display: flex;
			align-items: center;
			justify-content: center;
			gap: 10px;
		}

		.copy-url-btn:hover {
			transform: translateY(-3px);
			box-shadow: 0 8px 20px rgba(0, 122, 255, 0.4);
		}

		.copy-url-btn:active {
			transform: translateY(0);
			box-shadow: 0 5px 10px rgba(0, 122, 255, 0.3);
		}

		.copy-url-btn i {
			font-size: 1.2rem;
		}

		.theme-toggle {
			position: fixed;
			top: 20px;
			right: 20px;
			width: 50px;
			height: 50px;
			border-radius: 50%;
			display: flex;
			align-items: center;
			justify-content: center;
			background: var(--card-bg);
			color: var(--text-color);
			cursor: pointer;
			transition: var(--transition);
			box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
			border: 1px solid rgba(255, 255, 255, 0.05);
			z-index: 100;
			opacity: 0;
			transform: translateY(20px);
			animation: fadeInUp 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
			animation-delay: 1.2s;
		}

		.feedback-toggle {
			position: fixed;
			top: 80px;
			right: 20px;
			width: 50px;
			height: 50px;
			border-radius: 50%;
			display: flex;
			align-items: center;
			justify-content: center;
			background: var(--card-bg);
			color: var(--text-color);
			cursor: pointer;
			transition: var(--transition);
			box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
			border: 1px solid rgba(255, 255, 255, 0.05);
			z-index: 100;
			opacity: 0;
			transform: translateY(20px);
			animation: fadeInUp 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
			animation-delay: 1.3s;
		}

		.theme-toggle:hover, .feedback-toggle:hover {
			transform: scale(1.1);
		}

		.feedback-modal {
			position: fixed;
			top: 0;
			left: 0;
			right: 0;
			bottom: 0;
			background: rgba(0, 0, 0, 0.7);
			display: flex;
			align-items: center;
			justify-content: center;
			z-index: 1000;
			opacity: 0;
			visibility: hidden;
			transition: all 0.5s cubic-bezier(0.25, 0.8, 0.25, 1);
			backdrop-filter: blur(10px);
			-webkit-backdrop-filter: blur(10px);
		}

		.feedback-modal.active {
			opacity: 1;
			visibility: visible;
		}

		.feedback-content {
			background: var(--bg-color);
			border-radius: 30px;
			padding: 40px;
			width: 90%;
			max-width: 700px;
			max-height: 80vh;
			overflow-y: auto;
			box-shadow: var(--glass-shadow);
			backdrop-filter: var(--glass-backdrop);
			-webkit-backdrop-filter: var(--glass-backdrop);
			border: 1px solid var(--glass-border);
			position: relative;
			transform: scale(0.9);
			transition: all 0.5s cubic-bezier(0.23, 1, 0.32, 1);
			opacity: 0;
		}

		.feedback-modal.active .feedback-content {
			transform: scale(1);
			opacity: 1;
		}

		.close-feedback {
			position: absolute;
			top: 25px;
			right: 25px;
			width: 50px;
			height: 50px;
			border-radius: 50%;
			display: flex;
			align-items: center;
			justify-content: center;
			background: var(--card-bg);
			color: var(--text-color);
			cursor: pointer;
			transition: var(--transition);
			box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
			border: none;
		}

		.close-feedback:hover {
			transform: rotate(90deg);
			color: var(--accent-color);
		}

		.feedback-iframe {
			width: 100%;
			height: 500px;
			border: none;
			border-radius: 20px;
		}

		/* 响应式设计 */
		@media (max-width: 768px) {
			h1 {
				font-size: 2.5rem;
			}
			
			.glass-panel {
				padding: 25px;
			}
			
			.search-container {
				flex-direction: column;
			}
			
			.album-cover {
				width: 220px;
				height: 220px;
			}
			
			.controls {
				gap: 20px;
			}
			
			.control-btn {
				width: 60px;
				height: 60px;
			}
			
			.control-btn.play-pause {
				width: 80px;
				height: 80px;
			}
			
			.theme-toggle, .feedback-toggle {
				width: 50px;
				height: 50px;
				top: 20px;
				right: 20px;
			}
			
			.feedback-toggle {
				top: 80px;
			}
			
			.feedback-content {
				padding: 25px;
			}
			
			.feedback-iframe {
				height: 400px;
			}
		}

		@media (max-width: 480px) {
			h1 {
				font-size: 2rem;
			}
			
			.glass-panel {
				padding: 20px;
			}
			
			input[type="text"] {
				padding: 15px 20px;
				font-size: 1rem;
			}
			
			button {
				padding: 15px 25px;
				font-size: 1rem;
			}
			
			.quality-btn {
				padding: 10px 15px;
				font-size: 0.9rem;
			}
			
			.album-cover {
				width: 200px;
				height: 200px;
			}
			
			.song-title {
				font-size: 1.8rem;
			}
			
			.song-artist {
				font-size: 1.2rem;
			}
			
			.controls {
				gap: 15px;
			}
			
			.control-btn {
				width: 55px;
				height: 55px;
			}
			
			.control-btn.play-pause {
				width: 70px;
				height: 70px;
			}
			
			.feedback-iframe {
				height: 350px;
			}
		}

		/* 自定义滚动条 */
		::-webkit-scrollbar {
			width: 8px;
		}

		::-webkit-scrollbar-track {
			background: rgba(0, 0, 0, 0.05);
			border-radius: 10px;
		}

		::-webkit-scrollbar-thumb {
			background: linear-gradient(var(--primary-color), var(--secondary-color));
			border-radius: 10px;
		}

		::-webkit-scrollbar-thumb:hover {
			background: var(--secondary-color);
		}
	</style>
</head>
<body>
	<button class="theme-toggle" id="themeToggle">
		<i class="fas fa-moon"></i>
	</button>

	<button class="feedback-toggle" id="feedbackToggle">
		<i class="fas fa-comment-dots"></i>
	</button>

	<div class="feedback-modal" id="feedbackModal">
		<div class="feedback-content">
			<button class="close-feedback" id="closeFeedback">
				<i class="fas fa-times"></i>
			</button>
			<h2 style="text-align: center; margin-bottom: 20px; font-size: 1.8rem; color: var(--text-color);">问题反馈</h2>
			<iframe class="feedback-iframe" src="https://wj.qq.com/s2/23702452/1242/" frameborder="0"></iframe>
		</div>
	</div>

	<div class="container">
		<div class="glass-panel">
			<h1>高级音乐播放器</h1>
			
			<div class="search-container">
				<input type="text" id="searchInput" placeholder="搜索歌曲..." autocomplete="off">
				<button id="searchBtn"><i class="fas fa-search"></i> 搜索</button>
			</div>
			
			<div class="quality-selector">
				<div class="quality-btn" data-quality="2">标准 (128k)</div>
				<div class="quality-btn" data-quality="3">高品质 (192k)</div>
				<div class="quality-btn" data-quality="4">极高 (320k)</div>
				<div class="quality-btn active" data-quality="5">无损</div>
				<div class="quality-btn" data-quality="9">母带</div>
			</div>
			
			<div class="loading" id="loading">
				<div class="loading-spinner"></div>
				<p>加载中...</p>
			</div>
			
			<div class="error-message" id="errorMessage"></div>
			
			<div class="search-results" id="searchResults"></div>
			
			<div class="player-container" id="playerContainer">
				<div class="song-info">
					<img src="" alt="专辑封面" class="album-cover" id="albumCover">
					<h2 class="song-title" id="songTitle"></h2>
					<p class="song-artist" id="songArtist"></p>
					<p class="song-album" id="songAlbum"></p>
					<p class="song-quality" id="songQuality"></p>
					<p class="song-size" id="songSize"></p>
				</div>
				
				<div class="progress-container" id="progressContainer">
					<div class="progress-bar" id="progressBar"></div>
				</div>
				
				<div class="time-info">
					<span id="currentTime">0:00</span>
					<span id="duration">0:00</span>
				</div>
				
				<div class="controls">
					<button class="control-btn" id="prevBtn"><i class="fas fa-step-backward"></i></button>
					<button class="control-btn play-pause" id="playPauseBtn"><i class="fas fa-play"></i></button>
					<button class="control-btn" id="nextBtn"><i class="fas fa-step-forward"></i></button>
				</div>
				
				<div class="song-url-container">
					<label class="song-url-label">音乐播放地址:</label>
					<input type="text" id="songUrlInput" class="song-url-input" readonly>
					<button class="copy-url-btn" id="copyUrlBtn">
						<i class="fas fa-copy"></i> 复制到浏览器下载
					</button>
				</div>
			</div>
		</div>
	</div>

	<audio id="audioPlayer"></audio>

	<script>
		// DOM元素
		const themeToggle = document.getElementById('themeToggle');
		const feedbackToggle = document.getElementById('feedbackToggle');
		const feedbackModal = document.getElementById('feedbackModal');
		const closeFeedback = document.getElementById('closeFeedback');
		const searchInput = document.getElementById('searchInput');
		const searchBtn = document.getElementById('searchBtn');
		const qualityBtns = document.querySelectorAll('.quality-btn');
		const loading = document.getElementById('loading');
		const errorMessage = document.getElementById('errorMessage');
		const searchResults = document.getElementById('searchResults');
		const playerContainer = document.getElementById('playerContainer');
		const albumCover = document.getElementById('albumCover');
		const songTitle = document.getElementById('songTitle');
		const songArtist = document.getElementById('songArtist');
		const songAlbum = document.getElementById('songAlbum');
		const songQuality = document.getElementById('songQuality');
		const songSize = document.getElementById('songSize');
		const songUrlInput = document.getElementById('songUrlInput');
		const copyUrlBtn = document.getElementById('copyUrlBtn');
		const progressContainer = document.getElementById('progressContainer');
		const progressBar = document.getElementById('progressBar');
		const currentTimeEl = document.getElementById('currentTime');
		const durationEl = document.getElementById('duration');
		const prevBtn = document.getElementById('prevBtn');
		const playPauseBtn = document.getElementById('playPauseBtn');
		const nextBtn = document.getElementById('nextBtn');
		const audioPlayer = document.getElementById('audioPlayer');

		// 全局变量
		let currentQuality = 5;
		let searchResultsData = [];
		let currentSongIndex = -1;
		let isDarkMode = false;
		let searchAttempts = 0;
		const MAX_SEARCH_ATTEMPTS = 4;
		let playAttempts = 0;
		const MAX_PLAY_ATTEMPTS = 4;
		let currentProgress = 0;

		// 初始化
		function init() {
			// 主题切换
			themeToggle.addEventListener('click', toggleTheme);
			
			// 反馈功能
			feedbackToggle.addEventListener('click', () => {
				feedbackModal.classList.add('active');
			});
			
			closeFeedback.addEventListener('click', () => {
				feedbackModal.classList.remove('active');
			});
			
			feedbackModal.addEventListener('click', (e) => {
				if (e.target === feedbackModal) {
					feedbackModal.classList.remove('active');
				}
			});
			
			// 搜索功能
			searchBtn.addEventListener('click', searchMusic);
			searchInput.addEventListener('keypress', (e) => {
				if (e.key === 'Enter') searchMusic();
			});
			
			// 音质选择
			qualityBtns.forEach(btn => {
				btn.addEventListener('click', () => {
					qualityBtns.forEach(b => b.classList.remove('active'));
					btn.classList.add('active');
					const newQuality = parseInt(btn.dataset.quality);
					
					// 如果音质有变化才处理
					if (newQuality !== currentQuality) {
						currentQuality = newQuality;
						
						// 如果在播放状态下切换音质，立即重新请求当前歌曲
						if (playerContainer.style.display === 'flex' && currentSongIndex >= 0) {
							const currentTime = audioPlayer.currentTime;
							currentProgress = currentTime;
							playSong(currentSongIndex);
						}
						// 如果在搜索结果状态下切换音质，重新搜索
						else if (searchResults.style.display === 'block' && searchInput.value.trim()) {
							searchMusic();
						}
					}
				});
			});
			
			// 播放器控制
			playPauseBtn.addEventListener('click', togglePlayPause);
			prevBtn.addEventListener('click', playPrevious);
			nextBtn.addEventListener('click', playNext);
			progressContainer.addEventListener('click', setProgress);
			
			// 复制音乐地址
			copyUrlBtn.addEventListener('click', copySongUrl);
			
			// 音频事件监听
			audioPlayer.addEventListener('timeupdate', updateProgress);
			audioPlayer.addEventListener('ended', playNext);
			audioPlayer.addEventListener('play', () => {
				playPauseBtn.innerHTML = '<i class="fas fa-pause"></i>';
			});
			audioPlayer.addEventListener('pause', () => {
				playPauseBtn.innerHTML = '<i class="fas fa-play"></i>';
			});
			
			// 检查主题偏好
			checkThemePreference();

			// 为所有按钮添加点击动画
			document.querySelectorAll('button').forEach(button => {
				button.addEventListener('click', function() {
					this.style.transform = 'scale(0.95)';
					setTimeout(() => {
						this.style.transform = '';
					}, 200);
				});
			});
		}

		// 主题切换
		function toggleTheme() {
			isDarkMode = !isDarkMode;
			document.body.classList.toggle('dark-mode', isDarkMode);
			themeToggle.innerHTML = isDarkMode ? '<i class="fas fa-sun"></i>' : '<i class="fas fa-moon"></i>';
			localStorage.setItem('darkMode', isDarkMode);
		}

		// 检查本地存储的主题偏好
		function checkThemePreference() {
			const savedMode = localStorage.getItem('darkMode');
			if (savedMode !== null) {
				isDarkMode = savedMode === 'true';
				document.body.classList.toggle('dark-mode', isDarkMode);
				themeToggle.innerHTML = isDarkMode ? '<i class="fas fa-sun"></i>' : '<i class="fas fa-moon"></i>';
			}
		}

		// 搜索音乐
		async function searchMusic() {
			const query = searchInput.value.trim();
			if (!query) return;
			
			showLoading();
			hideError();
			hidePlayer();
			clearSearchResults();
			
			searchAttempts = 0;
			await attemptSearch(query);
		}

		// 尝试搜索音乐
		async function attemptSearch(query) {
			searchAttempts++;
			
			try {
				const response = await fetch(`https://api.vkeys.cn/v2/music/netease?word=${encodeURIComponent(query)}&quality=${currentQuality}`);
				const data = await response.json();
				
				if (data.code === 200 && data.data && data.data.length > 0) {
					// 搜索成功，显示结果
					searchResultsData = Array.isArray(data.data) ? data.data : [data.data];
					displaySearchResults(searchResultsData);
					hideLoading();
					return true;
				} else if (searchAttempts < MAX_SEARCH_ATTEMPTS) {
					// 未达到最大尝试次数，立即继续尝试
					return await attemptSearch(query);
				} else {
					// 达到最大尝试次数仍未成功
					showError('未找到相关歌曲，请尝试其他关键词');
					hideLoading();
					return false;
				}
			} catch (error) {
				console.error(`搜索失败(尝试${searchAttempts}):`, error);
				
				if (searchAttempts < MAX_SEARCH_ATTEMPTS) {
					// 未达到最大尝试次数，立即继续尝试
					return await attemptSearch(query);
				} else {
					// 达到最大尝试次数仍未成功
					showError('搜索失败，请检查网络连接');
					hideLoading();
					return false;
				}
			}
		}

		// 显示搜索结果
		function displaySearchResults(results) {
			searchResults.innerHTML = '';
			
			results.forEach((song, index) => {
				const item = document.createElement('div');
				item.className = 'search-result-item';
				item.innerHTML = `
					<img src="${song.cover}" alt="封面" class="search-result-cover">
					<div class="search-result-info">
						<div class="search-result-title">${song.song}</div>
						<div class="search-result-artist">${song.singer}</div>
					</div>
				`;
				item.addEventListener('click', () => playSong(index));
				item.style.animationDelay = `${index * 0.1}s`;
				searchResults.appendChild(item);
			});
			
			searchResults.style.display = 'block';
			searchResults.style.opacity = '1';
			searchResults.style.transform = 'translateY(0)';
		}

		// 播放歌曲
		async function playSong(index) {
			if (index < 0 || index >= searchResultsData.length) return;
			
			currentSongIndex = index;
			const song = searchResultsData[index];
			
			showLoading();
			hideError();
			
			playAttempts = 0;
			await attemptPlaySong(index);
		}

		// 尝试播放歌曲
		async function attemptPlaySong(index) {
			playAttempts++;
			const song = searchResultsData[index];
			
			try {
				// 如果已经有url直接播放，否则通过id获取
				if (song.url) {
					setupPlayer(song);
					return true;
				} else {
					const response = await fetch(`https://api.vkeys.cn/v2/music/netease?id=${song.id}&quality=${currentQuality}`);
					const data = await response.json();
					
					if (data.code === 200 && data.data) {
						// 更新搜索结果中的数据
						searchResultsData[index] = data.data;
						setupPlayer(data.data);
						return true;
					} else if (playAttempts < MAX_PLAY_ATTEMPTS) {
						// 未达到最大尝试次数，立即继续尝试
						return await attemptPlaySong(index);
					} else {
						// 达到最大尝试次数仍未成功
						showError('获取歌曲失败，请重试');
						hideLoading();
						return false;
					}
				}
			} catch (error) {
				console.error(`播放失败(尝试${playAttempts}):`, error);
				
				if (playAttempts < MAX_PLAY_ATTEMPTS) {
					// 未达到最大尝试次数，立即继续尝试
					return await attemptPlaySong(index);
				} else {
					// 达到最大尝试次数仍未成功
					showError('播放失败，请检查网络连接');
					hideLoading();
					return false;
				}
			}
		}

		// 设置播放器
		function setupPlayer(song) {
			// 更新UI
			albumCover.src = song.cover;
			songTitle.textContent = song.song;
			songArtist.textContent = song.singer;
			songAlbum.textContent = song.album;
			songQuality.textContent = `音质: ${song.quality}`;
			songSize.textContent = `大小: ${song.size}`;
			songUrlInput.value = song.url;
			
			// 设置音频源
			audioPlayer.src = song.url;
			audioPlayer.load();
			
			// 显示播放器
			showPlayer();
			
			// 自动播放
			audioPlayer.play().catch(error => {
				console.error('自动播放失败:', error);
				// 在用户交互后可以播放
				document.body.addEventListener('click', () => {
					audioPlayer.play().catch(e => console.error('播放失败:', e));
				}, { once: true });
			});
			
			// 恢复之前的播放进度
			if (currentProgress > 0) {
				audioPlayer.addEventListener('canplay', () => {
					audioPlayer.currentTime = currentProgress;
					currentProgress = 0; // 重置进度
				}, { once: true });
			}
			
			hideLoading();
		}

		// 复制音乐地址
		function copySongUrl() {
			if (!songUrlInput.value) return;
			
			songUrlInput.select();
			document.execCommand('copy');
			
			// 显示复制成功反馈
			const originalText = copyUrlBtn.innerHTML;
			copyUrlBtn.innerHTML = '<i class="fas fa-check"></i> 复制成功';
			copyUrlBtn.style.background = 'linear-gradient(135deg, #4CAF50, #2E7D32)';
			
			setTimeout(() => {
				copyUrlBtn.innerHTML = originalText;
				copyUrlBtn.style.background = 'linear-gradient(135deg, var(--primary-color), var(--secondary-color))';
			}, 2000);
		}

		// 播放上一首
		function playPrevious() {
			if (searchResultsData.length === 0) return;
			
			currentSongIndex = (currentSongIndex - 1 + searchResultsData.length) % searchResultsData.length;
			playSong(currentSongIndex);
		}

		// 播放下一首
		function playNext() {
			if (searchResultsData.length === 0) return;
			
			currentSongIndex = (currentSongIndex + 1) % searchResultsData.length;
			playSong(currentSongIndex);
		}

		// 切换播放/暂停
		function togglePlayPause() {
			if (audioPlayer.paused) {
				audioPlayer.play();
			} else {
				audioPlayer.pause();
			}
		}

		// 更新进度条
		function updateProgress() {
			const { currentTime, duration } = audioPlayer;
			const progressPercent = (currentTime / duration) * 100;
			progressBar.style.width = `${progressPercent}%`;
			
			// 更新时间显示
			currentTimeEl.textContent = formatTime(currentTime);
			durationEl.textContent = formatTime(duration);
		}

		// 设置进度
		function setProgress(e) {
			const width = this.clientWidth;
			const clickX = e.offsetX;
			const duration = audioPlayer.duration;
			audioPlayer.currentTime = (clickX / width) * duration;
		}

		// 格式化时间
		function formatTime(seconds) {
			if (isNaN(seconds)) return '0:00';
			
			const minutes = Math.floor(seconds / 60);
			const secs = Math.floor(seconds % 60);
			return `${minutes}:${secs < 10 ? '0' : ''}${secs}`;
		}

		// 显示加载中
		function showLoading() {
			loading.style.display = 'block';
			loading.style.opacity = '1';
			loading.style.transform = 'scale(1)';
		}

		// 隐藏加载中
		function hideLoading() {
			loading.style.display = 'none';
		}

		// 显示错误信息
		function showError(message) {
			errorMessage.textContent = message;
			errorMessage.style.display = 'block';
			errorMessage.style.opacity = '1';
			errorMessage.style.transform = 'translateY(0)';
		}

		// 隐藏错误信息
		function hideError() {
			errorMessage.style.display = 'none';
		}

		// 显示播放器
		function showPlayer() {
			playerContainer.style.display = 'flex';
			searchResults.style.display = 'none';
			playerContainer.style.opacity = '1';
			playerContainer.style.transform = 'translateY(0)';
		}

		// 隐藏播放器
		function hidePlayer() {
			playerContainer.style.display = 'none';
		}

		// 清空搜索结果
		function clearSearchResults() {
			searchResults.innerHTML = '';
			searchResults.style.display = 'none';
		}

		// 初始化应用
		init();
	</script>
</body>
</html>